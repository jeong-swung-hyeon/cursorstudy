"""
기존 엑셀 파일에 새로운 금시세 데이터를 추가합니다.
"""
from bs4 import BeautifulSoup
import pandas as pd
import sys
import io
import os

# Windows 콘솔 인코딩 설정
if sys.platform == 'win32':
    sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

# 새로운 HTML 데이터
new_html_content = '''<div id="example-table" class="tabulator" role="grid" tabulator-layout="fitColumns"><div class="tabulator-header" style="padding-right: 0px;"><div class="tabulator-headers" style="margin-left: 0px;"><div class="tabulator-col" role="columnheader" aria-sort="none" tabulator-field="date" title="" style="min-width: 40px; height: 40px; padding-top: 0px; width: 227px;"><div class="tabulator-col-content"><div class="tabulator-col-title">고시날짜</div></div></div><div class="tabulator-col" role="columnheader" aria-sort="none" tabulator-field="bid" title="" style="min-width: 40px; height: 40px; padding-top: 0px; width: 227px;"><div class="tabulator-col-content"><div class="tabulator-col-title">Bid</div></div></div><div class="tabulator-col" role="columnheader" aria-sort="none" tabulator-field="ask" title="" style="min-width: 40px; height: 40px; padding-top: 0px; width: 227px;"><div class="tabulator-col-content"><div class="tabulator-col-title">Ask</div></div></div><div class="tabulator-col" role="columnheader" aria-sort="none" tabulator-field="ask" title="" style="min-width: 40px; height: 40px; padding-top: 0px; width: 227px;"><div class="tabulator-col-content"><div class="tabulator-col-title">국제가 (USD/T.oz)</div></div></div><div class="tabulator-col" role="columnheader" aria-sort="none" tabulator-field="domesticPrice" title="" style="min-width: 40px; height: 40px; padding-top: 0px; width: 227px;"><div class="tabulator-col-content"><div class="tabulator-col-title">국내기준가 (₩/g)</div></div></div></div><div class="tabulator-frozen-rows-holder"></div></div><div class="tabulator-tableHolder" tabindex="0" style="height: 1224px;"><div class="tabulator-table" style="padding-top: 0px; padding-bottom: 0px;"><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.16</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,284.39</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,286.3</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,286.3</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">203,383</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.15</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,346.89</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,348.9</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,348.9</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">206,021</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.14</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,302.12</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,303.72</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,303.72</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">204,236</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.13</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,302.12</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,303.72</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,303.72</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">204,236</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.12</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,308.27</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,309.68</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,309.68</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">204,742</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.11</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,216.36</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,218.16</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,218.16</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">199,766</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.10</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,197.85</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,199.34</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,199.34</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">198,685</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.09</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,191.59</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,193.11</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,193.11</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">198,178</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.08</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,209.58</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,211.18</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,211.18</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">198,882</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.07</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,196.78</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,198.98</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,198.98</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">199,156</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.06</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,196.78</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,198.98</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,198.98</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">199,156</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.05</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,220.31</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,222.08</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,222.08</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">199,850</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.04</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,184.69</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,186.28</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,186.28</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">198,212</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.03</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,206.11</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,207.67</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,207.67</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">198,408</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.02</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,210.02</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,211.6</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,211.6</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">199,064</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.12.01</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,244.35</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,246.12</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,246.12</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">200,534</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.30</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,230.37</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,231.88</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,231.88</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">199,838</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.29</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,230.37</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,231.88</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,231.88</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">199,838</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.28</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,163.71</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,166.71</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,166.71</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">197,274</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.27</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,165.25</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,167.45</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,167.45</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">195,938</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.26</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,160.85</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,162.48</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,162.48</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">197,556</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.25</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,115.88</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,117.5</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,117.5</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">194,536</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.24</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,063.15</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,064.77</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,064.77</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">193,021</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.23</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,064.87</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,067.87</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,067.87</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">192,372</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.22</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,064.87</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,067.87</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,067.87</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">192,372</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.21</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,041.07</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,042.87</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,042.87</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">191,556</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.20</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,063.71</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,065.57</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,065.57</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">192,115</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.19</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,083.23</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,084.85</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,084.85</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">192,887</div></div><div class="tabulator-row tabulator-selectable tabulator-row-odd" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.18</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,036.51</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,038.33</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,038.33</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">190,458</div></div><div class="tabulator-row tabulator-selectable tabulator-row-even" role="row" style="padding-left: 0px;"><div class="tabulator-cell" role="gridcell" tabulator-field="date" title="" style="width: 227px; text-align: center; height: 40px;">2025.11.17</div><div class="tabulator-cell" role="gridcell" tabulator-field="bid" title="" style="width: 227px; text-align: center; height: 40px;">4,077.16</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,078.8</div><div class="tabulator-cell" role="gridcell" tabulator-field="ask" title="" style="width: 227px; text-align: center; height: 40px;">4,078.8</div><div class="tabulator-cell" role="gridcell" tabulator-field="domesticPrice" title="" style="width: 227px; text-align: center; height: 40px;">191,611</div></div></div></div>'''

def extract_data_from_html(html_content):
    """HTML에서 금시세 데이터를 추출합니다."""
    soup = BeautifulSoup(html_content, 'html.parser')
    
    # Tabulator 테이블 찾기
    table = soup.find('div', {'id': 'example-table'})
    if not table:
        table = soup.find('div', class_='tabulator')
    
    if not table:
        raise Exception("테이블을 찾을 수 없습니다.")
    
    # 테이블 행 찾기
    rows = table.find_all('div', class_='tabulator-row')
    data = []
    
    for row in rows:
        cells = row.find_all('div', class_='tabulator-cell')
        if len(cells) >= 5:
            data.append({
                '고시날짜': cells[0].get_text(strip=True),
                'Bid': cells[1].get_text(strip=True),
                'Ask': cells[2].get_text(strip=True),
                '국제가 (USD/T.oz)': cells[3].get_text(strip=True),
                '국내기준가 (₩/g)': cells[4].get_text(strip=True)
            })
    
    return data

if __name__ == "__main__":
    output_file = 'gold_prices.xlsx'
    
    print("기존 엑셀 파일 읽기 중...")
    # 기존 엑셀 파일 읽기
    if os.path.exists(output_file):
        existing_df = pd.read_excel(output_file)
        print(f"기존 데이터: {len(existing_df)}개")
    else:
        existing_df = pd.DataFrame()
        print("기존 파일이 없습니다. 새로 생성합니다.")
    
    print("\n새로운 HTML에서 데이터 추출 중...")
    # 새로운 HTML에서 데이터 추출
    new_data = extract_data_from_html(new_html_content)
    new_df = pd.DataFrame(new_data)
    print(f"새로운 데이터: {len(new_df)}개")
    
    # 두 데이터 병합
    if not existing_df.empty:
        # 중복 제거 (고시날짜 기준)
        combined_df = pd.concat([existing_df, new_df], ignore_index=True)
        combined_df = combined_df.drop_duplicates(subset=['고시날짜'], keep='first')
    else:
        combined_df = new_df
    
    # 날짜순으로 정렬 (최신 날짜가 위로)
    combined_df['고시날짜_정렬'] = pd.to_datetime(combined_df['고시날짜'], format='%Y.%m.%d', errors='coerce')
    combined_df = combined_df.sort_values('고시날짜_정렬', ascending=False)
    combined_df = combined_df.drop('고시날짜_정렬', axis=1)
    combined_df = combined_df.reset_index(drop=True)
    
    # 최대 100개까지만 저장
    if len(combined_df) > 100:
        combined_df = combined_df.head(100)
    
    # 엑셀 파일로 저장
    combined_df.to_excel(output_file, index=False, engine='openpyxl')
    
    print(f"\n[완료] 총 {len(combined_df)}개의 데이터를 {output_file}에 저장했습니다.")
    print(f"\n저장된 데이터 미리보기:")
    print(combined_df.head(10))
    print(f"\n전체 데이터 개수: {len(combined_df)}")
    print(f"\n날짜 범위: {combined_df['고시날짜'].min()} ~ {combined_df['고시날짜'].max()}")
